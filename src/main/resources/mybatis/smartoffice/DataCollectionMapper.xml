<?xml version="1.0" encoding="UTF-8" ?>
<!--简单来说，每一个Dao都有一个mapper.xml文件来进行操作-->
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.lab.project.smartoffice.common.datacollection.mapper.DataCollectionMapper">
    <insert id="insertBatch" parameterType="java.util.List" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO t_data_collection (
        space_id,
        space_type,
        space_type_name,
        space_name,
        space_position,
        space_capacity,
        space_pic_url,
        gateway_id,
        gateway_name,
        gateway_model,
        device_id,
        device_name,
        device_model,
        device_type,
        device_type_name,
        device_position,
        device_position_x,
        device_position_y,
        device_position_z,
        device_pic_url,
        device_length,
        device_width,
        device_height,
        strategy_id,
        strategy_name,
        strategy_is_enable,
        strategy_data,
        strategy_data_smaller_than,
        strategy_data_bigger_than,
        device_function_type,
        device_function_type_name,
        device_function_data,
        sort_no,
        create_time,
        create_by,
        update_time,
        update_by,
        version,
        del_flag
        ) VALUES
        <foreach collection="dataCollectionEntityList" item="item" separator=",">
            (
            #{item.spaceId},
            #{item.spaceType},
            #{item.spaceTypeName},
            #{item.spaceName},
            #{item.spacePosition},
            #{item.spaceCapacity},
            #{item.spacePicUrl},
            #{item.gatewayId},
            #{item.gatewayName},
            #{item.gatewayModel},
            #{item.deviceId},
            #{item.deviceName},
            #{item.deviceModel},
            #{item.deviceType},
            #{item.deviceTypeName},
            #{item.devicePosition},
            #{item.devicePositionX},
            #{item.devicePositionY},
            #{item.devicePositionZ},
            #{item.devicePicUrl},
            #{item.deviceLength},
            #{item.deviceWidth},
            #{item.deviceHeight},
            #{item.strategyId},
            #{item.strategyName},
            #{item.strategyIsEnable},
            #{item.strategyData},
            #{item.strategyDataSmallerThan},
            #{item.strategyDataBiggerThan},
            #{item.deviceFunctionType},
            #{item.deviceFunctionTypeName},
            #{item.deviceFunctionData},
            #{item.sortNo},
            #{item.createTime},
            #{item.createBy},
            #{item.updateTime},
            #{item.updateBy},
            #{item.version},
            #{item.delFlag}
            )
        </foreach>
    </insert>

    <select id="listDataCollectionGraph" resultType="com.lab.project.smartoffice.common.sdkcallback.domain.DataCollectionEntity">
        SELECT
               *
        FROM t_data_collection
        WHERE
            create_time > DATE_SUB(
                NOW(),
                INTERVAL 12 HOUR)
        <if test="spaceId != '' and spaceId != null">
            and space_id = #{spaceId}
        </if>
        <if test="deviceId != '' and deviceId != null">
            and device_id = #{deviceId}
        </if>
        <if test="deviceFunctionType != null">
            and device_function_type = #{deviceFunctionType}
        </if>
        ORDER BY create_by DESC
    </select>
</mapper>